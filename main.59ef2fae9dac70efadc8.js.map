{"version":3,"sources":["webpack:///./templates/card.hbs","webpack:///./scripts/fetch-service.js","webpack:///./scripts/modal-service.js","webpack:///./scripts/notify-service.js","webpack:///./scripts/main.js"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","FetchService","this","searchQuery","pageNumber","currentCount","perPage","fetchData","axios","request","baseURL","params","image_type","orientation","q","page","per_page","key","response","hits","totalHits","nextDataPortion","basicLightbox","require","onLoadingMsg","create","showLargeImg","e","target","hasAttribute","dataset","img","show","info","error","defaults","delay","notice","type","msg","text","refs","searchForm","document","querySelector","gallery","fetchService","preventDefault","currentTarget","elements","query","value","innerHTML","modalService","renderElements","notifyService","setObserveItem","console","warn","string","map","compiledTemplate","join","insertAdjacentHTML","close","addEventListener","observerItem","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","onLoadMore","unobserve","threshold","allGalleryItem","querySelectorAll","lastGalleryItem","length","observe"],"mappings":"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","file":"main.59ef2fae9dac70efadc8.js","sourcesContent":["var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<li class=\\\"gallery-item\\\">\\r\\n        <div class=\\\"photo-card\\\">\\r\\n          <img data-img=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"largeImageURL\") || (depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"largeImageURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":25},\"end\":{\"line\":3,\"column\":42}}}) : helper)))\n    + \"\\\" src=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatURL\") || (depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":49},\"end\":{\"line\":3,\"column\":65}}}) : helper)))\n    + \"\\\" width=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatWidth\") || (depth0 != null ? lookupProperty(depth0,\"webformatWidth\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatWidth\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":74},\"end\":{\"line\":3,\"column\":92}}}) : helper)))\n    + \"\\\" alt=\\\"\\\" height=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatHeight\") || (depth0 != null ? lookupProperty(depth0,\"webformatHeight\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatHeight\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":109},\"end\":{\"line\":3,\"column\":128}}}) : helper)))\n    + \"\\\" />\\r\\n          <div class=\\\"stats\\\">\\r\\n            <p class=\\\"stats-item\\\">\\r\\n              <i class=\\\"material-icons\\\">thumb_up</i>&nbsp;\\r\\n              \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":7,\"column\":14},\"end\":{\"line\":7,\"column\":23}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n              <i class=\\\"material-icons\\\">visibility</i>&nbsp;\\r\\n              \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":11,\"column\":14},\"end\":{\"line\":11,\"column\":23}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n              <i class=\\\"material-icons\\\">comment</i>&nbsp;\\r\\n              \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"comments\") || (depth0 != null ? lookupProperty(depth0,\"comments\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":15,\"column\":14},\"end\":{\"line\":15,\"column\":26}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n              <i class=\\\"material-icons\\\">cloud_download</i>&nbsp;\\r\\n              \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":19,\"column\":14},\"end\":{\"line\":19,\"column\":27}}}) : helper)))\n    + \"\\r\\n            </p>\\r\\n          </div>\\r\\n        </div>\\r\\n      </li>\";\n},\"useData\":true});","import axios from 'axios';\r\nconst API_KEY = '18927781-76591304de9a35a1d49e108a5';\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\n\r\nexport default class FetchService {\r\n  constructor() {\r\n    this.searchQuery = '';\r\n    this.pageNumber = 1;\r\n    this.currentCount = 0;\r\n    this.perPage = 12;\r\n  }\r\n\r\n  async fetchData() {\r\n    try {\r\n      const response = await axios.request({\r\n        baseURL: `${BASE_URL}`,\r\n        params: {\r\n          image_type: 'photo',\r\n          orientation: 'horizontal',\r\n          q: this.searchQuery,\r\n          page: this.pageNumber,\r\n          per_page: this.perPage,\r\n          key: API_KEY,\r\n        },\r\n      });\r\n      const { hits, totalHits } = response.data;\r\n      return { hits, totalHits };\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async nextDataPortion() {\r\n    this.pageNumber += 1;\r\n    this.currentCount = this.pageNumber * this.perPage;\r\n    return this.fetchData();\r\n  }\r\n}\r\n","const basicLightbox = require('basiclightbox');\r\n\r\nconst onLoadingMsg = basicLightbox.create(`\r\n        <p class='loading'>loading...</p>\r\n`);\r\n\r\nfunction showLargeImg(e) {\r\n  if (!e.target.hasAttribute('data-img')) return;\r\n  const instance = basicLightbox.create(`\r\n    <img src=\"${e.target.dataset.img}\" width=\"800\" height=\"600\">\r\n`);\r\n  instance.show();\r\n}\r\n\r\nexport default { onLoadingMsg, showLargeImg };\r\n","const { info, error, defaults } = require('@pnotify/core');\r\ndefaults.delay = 2000;\r\n\r\nfunction notice(type, msg) {\r\n  if (type == 'error') {\r\n    return error({\r\n      text: msg,\r\n    });\r\n  }\r\n  if (type == 'info') {\r\n    return info({\r\n      text: msg,\r\n    });\r\n  }\r\n  return;\r\n}\r\nexport default notice;\r\n","import compiledTemplate from '../templates/card.hbs';\r\nimport FetchService from '../scripts/fetch-service';\r\nimport modalService from '../scripts/modal-service';\r\nimport notifyService from '../scripts/notify-service';\r\n\r\nconst refs = {\r\n  searchForm: document.querySelector('.js-search-form'),\r\n  gallery: document.querySelector('.gallery'),\r\n};\r\nconst fetchService = new FetchService();\r\n\r\nrefs.searchForm.addEventListener('submit', onSubmit);\r\nrefs.gallery.addEventListener('click', modalService.showLargeImg);\r\n//--\r\nasync function onSubmit(e) {\r\n  e.preventDefault();\r\n  fetchService.pageNumber = 1;\r\n  fetchService.searchQuery = e.currentTarget.elements.query.value;\r\n  refs.gallery.innerHTML = '';\r\n  modalService.onLoadingMsg.show();\r\n  try {\r\n    const { hits, totalHits } = await fetchService.fetchData();\r\n    renderElements(hits);\r\n\r\n    if (totalHits == 0) {\r\n      notifyService('error', 'Bad request');\r\n      return;\r\n    }\r\n    if (totalHits <= fetchService.perPage) {\r\n      notifyService('info', 'All content is loaded');\r\n      return;\r\n    }\r\n    setObserveItem();\r\n  } catch (error) {\r\n    console.warn('fetch error: ', { error });\r\n  }\r\n}\r\n\r\nasync function onLoadMore() {\r\n  modalService.onLoadingMsg.show();\r\n  try {\r\n    const { hits, totalHits } = await fetchService.nextDataPortion();\r\n    renderElements(hits);\r\n    if (fetchService.currentCount >= totalHits) {\r\n      notifyService('info', 'All content is loaded');\r\n      return;\r\n    }\r\n    setObserveItem();\r\n  } catch (error) {\r\n    console.warn('fetch error: ', { error });\r\n  }\r\n}\r\n\r\nfunction renderElements(data) {\r\n  const string = data.map(compiledTemplate).join('');\r\n  refs.gallery.insertAdjacentHTML('beforeend', string);\r\n  modalService.onLoadingMsg.close();\r\n}\r\n\r\n//----\r\nconst observerItem = new IntersectionObserver(\r\n  (entries, observer) => {\r\n    entries.forEach(entry => {\r\n      if (entry.isIntersecting) {\r\n        onLoadMore();\r\n        observer.unobserve(entry.target);\r\n      }\r\n    });\r\n  },\r\n  { threshold: 0.75 },\r\n);\r\n\r\nfunction setObserveItem() {\r\n  const allGalleryItem = document.querySelectorAll('.gallery-item');\r\n  const lastGalleryItem = allGalleryItem[allGalleryItem.length - 1];\r\n  observerItem.observe(lastGalleryItem);\r\n}\r\n"],"sourceRoot":""}